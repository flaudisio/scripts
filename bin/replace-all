#!/bin/bash
#
# replace all
# Replace all occurences of 'pattern' by 'subject' in 'folder'
#
##

### Settings

Program="$( basename "$BASH_SOURCE" )"

[[ $# < 2 ]] && {
    echo "${Program}: missing operands." >&2
    exit 1
}

### Main

pattern="$1"
subject="$2"
folder="$3"

[ -z "$3" ] && folder="."

echo -e "\nReplacing '$pattern' with '$subject' in all files inside '$folder', please wait...\n"

fgrep -r "$pattern" "$folder" \
    | cut -d ':' -f 1 \
    | sort \
    | uniq \
    | fgrep -v '.git' \
    | xargs -I '{}' sed -ri 's|'"$pattern"'|'"$subject"'|g' '{}' \
    || exit 1

echo -e "\nDone.\n"

exit 0
