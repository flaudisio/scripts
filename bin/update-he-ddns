#!/bin/bash
#
# update-he-ddns
# Atualizador de DDNS hospedado no Hurricane Electric
#
# Autor     : Flaudísio Tolentino <flaudisio@flaudisio.com
# Data      : Sun May 12 05:02:04 BRT 2013
# Licença   : GPLv2
#
##

# Processamento de argumentos
while true ; do
    case $1 in
        -c|--cron) Prefix="[$( date +'%d/%m/%y %H:%M:%S' )] " ; shift ;;
                *) break ;;
    esac
done

[[ $# == 0 ]] && {
    echo "uso: $( basename "$0" ): <domain> <password>" >&2
    exit 1
}

Domain="$1"
User="$Domain"
Pass="$2"

[ "$Pass" ] || {
    read -s -p "Senha: " Pass
    echo
}

echo -n "${Prefix}Atualizando... "

curl -4 -sS \
    "http://${User}:${Pass}@dyn.dns.he.net/nic/update?hostname=$Domain"

echo

exit 0
